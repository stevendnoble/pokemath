$(document).ready(function() {
  $(".pokemons.show").ready(function() {

    var $battleEncounter = $('#battle-encounter'),
        $battleQuestions = $('#battle-questions'),
        $battleCaught = $('#battle-caught'),
        $battleEscaped = $('#battle-escaped'),
        $battleToggle = $('.battle-toggle');

    var $gameScreen = $('.game-screen'),
        $battleScreen = $('#battle-screen');

    var $problemNumber = $('#problem-number'),
        $num1 = $('#num1'),
        $num2 = $('#num2'),
        $operation = $('#operation'),
        $choice1 = $('#choice1'),
        $choice2 = $('#choice2'),
        $choice3 = $('#choice3');

    var keyPressed;
    var questions;

    // Sets the height of a tile to be the same as the width
    // to make each one a square
    function setSizeBattle() {
      var screenHeight = Math.floor($gameScreen.width() / 12);
      $battleScreen.height(6*screenHeight);
    }
    setSizeBattle();
    $(window).on("resize", setSizeBattle);

    function selectView(selector) {
      $battleToggle.hide();
      selector.show();
    }

    // Opens up the battle questions view
    function startBattle() {
      selectView($battleEncounter);
      $(document).on('keypress', function(event) {
        keyPressed = event.which;
        if (keyPressed === 32) {
          $(document).off('keypress');
          selectView($battleQuestions);
          displayQuestions();
        }
      });
    }

    // Inputs the values of the question on the html page    
    function inputValues(questionNumber, question) {
      $problemNumber.html(questionNumber);
      $num1.html(question.num1);
      $num2.html(question.num2);
      $operation.html(question.operation);
      $choice1.html(question.choices[0]);
      $choice2.html(question.choices[1]);
      $choice3.html(question.choices[2]);
    }

    var questionNumber = 1;

    // Displays the questions
    function displayQuestions(questionNumber) {
      question = createAdditionProblem(3, 0, 10);
      inputValues(questionNumber, question);
      $(document).on('keypress', function(event) {
        keyPressed = event.which;
        if (keyPressed >= 106 && keyPressed <= 108) {
          if ((keyPressed === 106 && question.answer === question.choices[0]) ||
             (keyPressed === 107 && question.answer === question.choices[1]) ||
             (keyPressed === 108 && question.answer === question.choices[2])) {
            if (questionNumber === 4) {
              // replace image with pokeball
              displayQuestions(questionNumber++)
            } else if (questionNumber === 5) {
              // replace image with pokeball
              selectView($battleCaught);
            } else {
              displayQuestions(questionNumber++);
            }
          } else {
            selectView($battleEscaped);
          }
        }
      });
    }

    function checkAnswer(keyPressed, question) {
      return 
    }

    $(document).on('keypress', function(event) {
      keyPressed = event.which;
      if ([97, 100, 115, 106, 107, 108].indexOf(keyPressed) !== -1) {
        pressKey(keyPressed);
      }
    });



    startBattle();

    
  });

  function startTimer(duration, display) {
    var timer = duration;
    var seconds;
    var interval = setInterval(function () {
      seconds = timer;
      if(seconds < 10) {
        seconds = "0" + seconds;
      }
      display.text("0:" + seconds);
      //Auto resets timer once reaches 0. 
      //If need to reset, funct clearInterval. setInterval return value as parameter. 
      if (--timer < 0) {
        //timer = duration;
        clearInterval(interval);
      }
    }, 1000);
  }

  // jQuery(function ($) {
  //    var fiveMinutes = 60 * 5,
  //        tenSeconds = 10,
  //        display = $('#time');
  //    startTimer(tenSeconds, display);
  // });


});