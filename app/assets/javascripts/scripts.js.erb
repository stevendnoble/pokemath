var resizeTimer;
var userQuestionTypes;

// Checks the size of the browser and alerts the user if
// window is too small to view
function browserTooSmall() {
  if (resizeTimer) {
    clearTimeout(resizeTimer);
  }
  resizeTimer = setTimeout(function() {
    var winWidth = $(window).width();
    var winHeight = $(window).height();

    if ((winWidth < 640) || (winHeight < 480)) {
      alert('Window size too small!');
    }
  }, 500);
}
// browserTooSmall();

function saveQuestionTypes() {
  $.ajax({
    type: "post",
    url: "/user_question_type",
    data: { 'userQuestionTypes': JSON.stringify(userQuestionTypes) },
    success: function() {
      $('#questionModal').modal('toggle'); 
    }
  });
};

function loadQuestionTypes() {
  $.ajax({
    type: "get",
    url: "/user_question_type",
    success: function(data) {
      userQuestionTypes = data.userQuestionTypes;
      var checkBoxes = $('.checkbox > label > input');
      for(var box=0; box<checkBoxes.length; box++) {
        if (userQuestionTypes.indexOf(checkBoxes[box].name) !== -1) {
          checkBoxes[box].checked = true;
        }
      }

    } 
  });
}

// Global variables
$(document).ready(function() {

  $('#save-question').on('click', function(event) {
    event.preventDefault();
    userQuestionTypes = [];
    var checkBoxes = $('.checkbox > label > input');
    for(var box=0; box<checkBoxes.length; box++) {
      if (checkBoxes[box].checked) {
        userQuestionTypes.push(checkBoxes[box].name);
      }
    }
    saveQuestionTypes();
  });

  loadQuestionTypes();
});